webpackJsonp([69],{"ErM+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("woOf"),o=i.n(a),r=i("RRo+"),l=i.n(r),n=i("xJrl"),s={name:"bpgift",data:function(){return{loading:!0,tableLoading:!1,dialogTitle:"添加礼物",dialogFormVisible:!1,bpGiftForm:{title:"",icon:"",default_price:"",time:"",url:""},bpGiftFormRules:{title:[{required:!0,trigger:"blur",message:"请输入主题名称"},{max:5,trigger:"blur",message:"主题名称不能超过5个字符"}],icon:[{required:!0,trigger:"blur",message:"请上传图片"}],default_price:[{required:!0,validator:function(t,e,i){if(!e)return i(new Error("请输入"+t.label));l()(Number(e))?i():i(new Error("请输入整数"))},trigger:"blur",label:"价格"}],time:[{required:!0,validator:function(t,e,i){if(!e)return i(new Error("请输入"+t.label));l()(Number(e))?i():i(new Error("请输入整数"))},trigger:"blur",label:"时间"}],url:[{required:!0,trigger:"blur",message:"请输入礼物地址"}]},tableData:[],params:{page:1,pageSize:10},total:0}},created:function(){this.getData()},mounted:function(){this.bpGiftFormReset=o()({},this.bpGiftForm)},methods:{getData:function(){var t=this;this.loading=!0,Object(n.e)(this.params).then(function(e){var i=e.data.result;t.tableData=i.data,t.total=i.total,t.loading=!1}).catch(function(e){t.loading=!1})},clearForm:function(){this.$refs.bpGiftForm.clearValidate(),this.$refs.bpGiftForm.resetFields(),this.bpGiftForm=o()({},this.bpGiftFormReset)},handleSizeChange:function(t){this.params.pageSize=t,this.getData()},handleCurrentChange:function(t){this.params.page=t,this.getData(),console.log("当前页: "+t)},showEmptyDiaLog:function(){this.dialogTitle="添加礼物",this.dialogFormVisible=!0},handleEdit:function(t,e){this.bpGiftForm=o()({},t),this.dialogTitle="编辑礼物",this.dialogFormVisible=!0},handleDelete:function(t,e){var i=this;this.$confirm("是否确定删除该礼物?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.d)({id:t.id}).then(function(){i.$message({type:"success",message:"删除成功!"}),i.getData()}).catch(function(t){i.$message({type:"error",message:t.msg})})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},_beforeAddBpTime:function(){var t=this;this.$refs.bpGiftForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;var i=function(){},a="";"添加礼物"==t.dialogTitle?(i=n.a,a="添加成功"):(i=n.h,a="更新成功"),i(t.bpGiftForm).then(function(e){t.$message({message:a,type:"success"}),t.clearForm(),t.dialogFormVisible=!1,t.getData()}).catch(function(e){t.$message({message:e.msg,type:"error"})})})},uploadIcon:function(t){var e=this;if(this.beforeIconUpload(t.file)){var i=new FormData;i.append("file",t.file),Object(n.k)(i).catch(function(t){e.$message.error("上传失败，请重新上传")}).then(function(t){e.$message.success("上传成功"),e.bpGiftForm.icon=t.data.result})}},beforeIconUpload:function(t){var e=t.size/1024<50;return e||this.$message.error("上传图片大小不能超过 50K!"),e},beforeZipUpload:function(t){var e="application/x-zip-compressed"===t.type;return e||(this.$message.error("文件包只能是Zip格式！"),!1)},handleExceedZip:function(t,e){console.log("exceed"),this.$message.error("请先删除原有的文件包再上传！")},beforeRemoveZip:function(t,e){return this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})},handleRemoveZip:function(t,e){console.log(t)}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"sub-container"},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){t.showEmptyDiaLog(e)}}},[t._v("添加礼物")])],1)],1),t._v(" "),i("div",{staticStyle:{height:"24px"}}),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[i("el-table-column",{attrs:{prop:"title",label:"礼物名称",width:"220"}}),t._v(" "),i("el-table-column",{attrs:{prop:"icon",label:"图片",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("img",{staticStyle:{width:"80px",height:"80px"},attrs:{src:t._f("uploadPrefixUrl")(e.row.icon)}})]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"type",label:"类型",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"default_price",label:"价格",width:"160"}}),t._v(" "),i("el-table-column",{attrs:{prop:"time",label:"时间",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleEdit(e.row,e.$index)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){t.handleDelete(e.row,e.$index)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("div",{staticClass:"pagination-container"},[i("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.clearForm}},[i("el-form",{ref:"bpGiftForm",attrs:{model:t.bpGiftForm,"status-icon":"",rules:t.bpGiftFormRules,"label-width":"140px"}},[i("el-form-item",{attrs:{label:"礼物名称",prop:"title"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.bpGiftForm.title,callback:function(e){t.$set(t.bpGiftForm,"title",e)},expression:"bpGiftForm.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"图片",prop:"icon"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{accept:"image/*",action:"","http-request":t.uploadIcon,"show-file-list":!1,"before-upload":t.beforeIconUpload}},[t.bpGiftForm.icon?i("img",{staticClass:"avatar",attrs:{src:t._f("uploadPrefixUrl")(t.bpGiftForm.icon)}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),i("el-form-item",{attrs:{label:"价格",prop:"default_price"}},[i("el-input",{attrs:{"auto-complete":"off",type:"number"},model:{value:t.bpGiftForm.default_price,callback:function(e){t.$set(t.bpGiftForm,"default_price",e)},expression:"bpGiftForm.default_price"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"时间",prop:"time"}},[i("el-input",{attrs:{"auto-complete":"off",type:"number"},model:{value:t.bpGiftForm.time,callback:function(e){t.$set(t.bpGiftForm,"time",e)},expression:"bpGiftForm.time"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"礼物地址",prop:"url"}},[i("el-input",{attrs:{"auto-complete":"off"},model:{value:t.bpGiftForm.url,callback:function(e){t.$set(t.bpGiftForm,"url",e)},expression:"bpGiftForm.url"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t._beforeAddBpTime}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]},u=i("VU/8")(s,c,!1,null,null,null);e.default=u.exports}});